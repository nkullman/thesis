% ========== Appendix A
 
\chapter{Computing a Frontier's Hypervolume Indicator}
\label{chap:appAHypervolumeAlgo}

Given a set of Pareto optimal solutions $\mathcal{P}$ to a multi-objective mathematical programming model with a set of objectives $O$ of cardinality $N := |O|$, this algorithm computes the volume $V$ of the objective space bounded by the Pareto frontier defined by the solutions $x \in \mathcal{P}$. The objectives are assumed to be normalized so that the objective space is the $N$-dimensional unit hypercube with the origin and the point $\vec{\mathbf{1}}$ defining the nadir objective vector and the ideal objective vector, respectively. That is, all objectives are assumed to be maximized with bounds $[0,1]$.

The algorithm projects the objective space into $N-1$ dimensions by eliminating the dimension associated with an (arbitrarily-chosen) objective $p \in O$. The set of objectives is $\overbar{O} := O \backslash \{p\}$. It is assumed that $x \in \mathcal{P}$ are sorted in descending order according to $p$. The algorithm proceeds by sequentially adding solutions to the ($N-1$)-dimensional space, and calculating the contribution to the frontier volume as a product of the volume contribution in $N-1$ dimensions and its achievement in objective $p$.

Let $\overbar{V_x}$ be the ($N-1$)-dimensional volume contribution of solution $x$ and
$x_p$ be the achievement of solution $x$ in objective $p$. Further, let
$F$ be the set of non-dominated solutions in $N-1$ dimensions.
I compute the $N$-dimensional volume of the frontier $V$ as follows.

\begin{figure}[!ht]
\caption{Algorithm to compute the volume of a Pareto frontier}
\begin{algorithmic}[1]

\State $V \gets 0$
\State $\overbar{V} \gets 0$
\State $F \gets \emptyset$

% Iterate over each solution
\ForAll{$x \in \mathcal{P}$}

	\State $\overbar{V}_x \gets \prod_{o \in \overbar{O}} x_{o} - \overbar{V}$
		
	\ForAll{$f \in F$}
		\If{$f_o < x_o \forall o \in \overbar{O}$}
			\State $F \gets F \backslash \{f\}$
		\EndIf
	\EndFor
	
	% iterate over subdimensions to "add back the sides"	
	\ForAll{$o \in \overbar{O}$}
	
		\State $F_{x,o} := \set{f \in F : f_o > x_o}$
		
		\State Sort $f \in F_{x,o}$ in ascending order by their $o$th component, $f_o$
		
		\State $v_i \gets x_o$
		\ForAll{$f \in F_{x,o}$}
			\State $v_t \gets f_o$
			\State $\delta_o :	= v_t - v_i$
			\State $\overbar{V}_x \gets \overbar{V}_x + \delta_o \prod_{\sigma \in \overbar{O} \backslash \{o\}} f_\sigma$
			\State $v_i \gets v_t$
		\EndFor
		
	\EndFor
	
	\State $F \gets F \cup \{x\}$
	\State $\overbar{V} \gets \overbar{V} + \overbar{V}_x$
	\State $V \gets V + x_p \overbar{V}_x$
\EndFor


\end{algorithmic}
\end{figure}